Route
Home automation and event router

-------------------------------------------------------------------------------
Example Usage

var Route = require('./route').Route;

route = new Route();

route.addDevice({
  type : require('./insteon').Insteon,
  name : "Insteon",
  init : {
    host : "10.0.1.120",
    commands : {
      "LivingRoomLightsOn" : "0261211121",
      "LivingRoomLightsOff" : "0261211321",
    }
  }
});

route.addDevice({
  type : require('./sonos').Sonos,
  name : "Sonos",
  init : {
    host : "10.0.1.16",
  }
});

route.addDevice({
  type : require('./web').Web,
  name : "Web",
  init : {
    port : 8000
  }
});

route.addEventMap({
  // Turns living room lights on when the Sonos starts playing
  "Sonos.Started" : ["Insteon.LivingRoomLightsOn"],
  "Sonos.Started" : ["Insteon.LivingRoomLightsOn"],

  // Turns the Sonos on and Living room lights on when something
  // or someone hits http://localhost:8000/event/ImHome/
  "Web.ImHome" : [
    "Insteon.LivingRoomLightsOn",
    "Sonos.Play"
  ],

  // Turns everything off when the second off switch is hit on 
  // Insteon remote 1C4C33
  "Insteon.02501C4C33000002C71300" : [
    "Insteon.LivingRoomLightsOff",
    "Sonos.Pause"
  ]
});

-------------------------------------------------------------------------------
Configuration

To get the redeye commands, you need to download the control database from 
your RedEye <http://[REDEYEIP]/setup/maintenance.html>, then use 
SQLLiteExplorer to find the 'signal' value for the commands you need
in the 'command' table. The final URL is constructed using that value
in the following:

  "/cgi-bin/play_iph.sh?/[SIGNALPATH]%201"

You're meant to be able to use the iOS app to extract these paths, but I could
never get that to work.

-------------------------------------------------------------------------------
Installation

You can run this as a service on Windows using NSSM <http://nssm.cc>:

  nssm.exe install emerson-node "C:\path\to\node.exe" c:\path\to\emerson.js
  net start emerson-node

To run on Linux, you'll need to modify emerson_upstart.conf to point to the 
right user and directory, then do:

  $ sudo apt-get install upstart
  $ sudo cp ./emerson_upstart.conf /etc/init/
  $ sudo start emerson_upstart
  
-------------------------------------------------------------------------------
Author

Glen Murphy
http://glenmurphy.com/